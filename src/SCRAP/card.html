<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cosmic Image Grid</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overflow: hidden;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            position: relative;
            background: transparent;
        }

        .stage {
            position: relative;
            width: 100%;
            height: 100%;
            perspective: 1000px;
            z-index: 1;
        }

        .character-image {
            position: absolute;
            width: 120px;
            height: 120px;
            border-radius: 15px;
            background-size: cover;
            background-position: center;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.6),
                        0 0 40px rgba(102, 126, 234, 0.5);
            border: 2px solid rgba(255, 255, 255, 0.2);
            transform-style: preserve-3d;
            transition: all 2s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 10;
            -webkit-backdrop-filter: blur(5px);
            backdrop-filter: blur(5px);
        }

        /* Phase 1: All images start at center, stacked and invisible */
        .phase-1 .character-image {
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.3) rotateY(0deg) rotateX(0deg);
            opacity: 0;
            z-index: 10;
        }

        /* Phase 2: Images become visible and expand to grid positions */
        .phase-2 .character-image {
            transform: translate(-50%, -50%) rotateY(0deg) rotateX(0deg) scale(var(--card-scale, 0.8));
            opacity: 0.9;
            z-index: 10;
        }

        /* Phase 3: Ripple effect - images pushed outward (final phase) */
        .phase-3 .character-image {
            transform: translate(-50%, -50%) rotateY(0deg) rotateX(0deg) scale(var(--card-scale, 0.8));
            opacity: 0.9;
            transition: all 1.2s cubic-bezier(0.22, 1, 0.36, 1); /* Smoother, faster easing */
            z-index: 10;
        }

        .ripple-wave {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border: 3px solid transparent; /* Changed from white to transparent */
            border-radius: 50%;
            transform: translate(-50%, -50%);
            opacity: 0; /* Keep opacity at 0 to ensure it's not visible */
            pointer-events: none;
            z-index: 5;
            visibility: hidden; /* Added to ensure it's not visible */
        }

        .ripple-wave.active {
            animation: ripple-expand 2s ease-out forwards;
        }

        /* Particle animations removed */

        /* Animations */
@keyframes ripple-expand {
            0% {
                width: 0;
                height: 0;
                opacity: 0.8;
                border-width: 3px;
            }
            30% {
                width: 200px;
                height: 200px;
                opacity: 0.6;
                border-width: 2px;
            }
            70% {
                width: 600px;
                height: 600px;
                opacity: 0.3;
                border-width: 1px;
            }
            100% {
                width: 1000px;
                height: 1000px;
                opacity: 0;
                border-width: 1px;
            }
        }

        @keyframes outward-particle {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            10% {
                opacity: 1;
            }
            80% {
                opacity: 1;
                transform: translate(var(--dx), var(--dy)) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(var(--dx), var(--dy)) scale(0.5);
            }
        }
        
        
    </style>
</head>
<body>
    <div class="stage phase-1" id="stage">
        <!-- Images will be dynamically generated here -->
        
<!-- Ripple wave effect -->
        <div class="ripple-wave" id="rippleWave"></div>
    </div>
    
    

    <script>
        let animationTimeout;
        let currentCardCount = 0;
        
        // Astronaut image URLs from Unsplash
        const astronautImages = [
            "https://images.unsplash.com/photo-1506973035872-a4ec16b8e8d9?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1446776653964-20c1d3a81b06?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1462331940025-496dfbfc7564?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1464802686167-b939a6910659?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1457364887197-9150188c107b?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1468276311594-df7cb65d8df6?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1451186859696-371d9477be93?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1444703686981-a3abbc4d4fe3?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1502134249126-9f3755a50d78?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1465101162946-4377e57745c3?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1505506874110-6a7a69069a08?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1462331940025-496dfbfc7564?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1464802686167-b939a6910659?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1506973035872-a4ec16b8e8d9?w=200&h=200&fit=crop",
            "https://images.unsplash.com/photo-1446776653964-20c1d3a81b06?w=200&h=200&fit=crop"
        ];
        
        function getScreenSize() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            
            // Calculate optimal grid based on screen dimensions
            let cols, rows, cardSize;
            
            if (width >= 1920) {
                cols = 13; rows = 8; cardSize = 90;
            } else if (width >= 1600) {
                cols = 11; rows = 7; cardSize = 85;
            } else if (width >= 1440) {
                cols = 10; rows = 7; cardSize = 80;
            } else if (width >= 1200) {
                cols = 9; rows = 6; cardSize = 75;
            } else if (width >= 992) {
                cols = 8; rows = 6; cardSize = 70;
            } else if (width >= 768) {
                cols = 7; rows = 5; cardSize = 65;
            } else if (width >= 576) {
                cols = 6; rows = 5; cardSize = 55;
            } else if (width >= 480) {
                cols = 5; rows = 4; cardSize = 50;
            } else {
                cols = 4; rows = 4; cardSize = 40;
            }
            
            // Adjust for very tall screens
            if (height > width * 1.3) {
                rows = Math.min(rows + 2, 8);
            }
            
            const totalCards = cols * rows;
            
            return { 
                size: width >= 1920 ? 'xl' : width >= 1440 ? 'lg' : width >= 992 ? 'md' : 'sm',
                cards: totalCards,
                cols: cols,
                rows: rows,
                cardSize: cardSize
            };
        }
        
        function calculateGridPositions(cardCount) {
            const positions = [];
            const screenInfo = getScreenSize();
            
            // Use actual screen calculations
            const cols = screenInfo.cols;
            const rows = screenInfo.rows;
            const maxCards = cols * rows;
            const actualCards = Math.min(cardCount, maxCards);
            
            // Calculate spacing to fill entire screen
            const marginX = 3;
            const marginY = 3;
            const availableWidth = 100 - (marginX * 2);
            const availableHeight = 100 - (marginY * 2);
            const stepX = cols > 1 ? availableWidth / (cols - 1) : 0;
            const stepY = rows > 1 ? availableHeight / (rows - 1) : 0;
            
            // Generate positions to fill grid completely
            let index = 0;
            for (let row = 0; row < rows && index < actualCards; row++) {
                for (let col = 0; col < cols && index < actualCards; col++) {
                    const x = marginX + (col * stepX);
                    const y = marginY + (row * stepY);
                    positions.push({ x, y });
                    index++;
                }
            }
            
            return positions;
        }

        function calculateRipplePositions(cardCount) {
            const positions = [];
            const screenInfo = getScreenSize();
            
            // Same grid dimensions as normal but slightly adjusted spacing
            const cols = screenInfo.cols;
            const rows = screenInfo.rows;
            const maxCards = cols * rows;
            const actualCards = Math.min(cardCount, maxCards);
            
            // Calculate spacing
            const marginX = 2.5;
            const marginY = 2.5;
            const availableWidth = 100 - (marginX * 2);
            const availableHeight = 100 - (marginY * 2);
            const stepX = cols > 1 ? availableWidth / (cols - 1) : 0;
            const stepY = rows > 1 ? availableHeight / (rows - 1) : 0;
            
            // Generate all positions
            let index = 0;
            for (let row = 0; row < rows && index < actualCards; row++) {
                for (let col = 0; col < cols && index < actualCards; col++) {
                    const x = marginX + (col * stepX);
                    const y = marginY + (row * stepY);
                    positions.push({ x, y });
                    index++;
                }
            }
            
            return positions;
        }

        function createCharacterCards() {
            const stage = document.getElementById('stage');
            const screenInfo = getScreenSize();
            const cardCount = screenInfo.cards;
            currentCardCount = cardCount;
            
            // Clear existing cards
            const existingCards = stage.querySelectorAll('.character-image');
            existingCards.forEach(card => card.remove());
            
            // Get all position sets
            const initialPositions = calculateGridPositions(cardCount);
            const ripplePositions = calculateRipplePositions(cardCount);
            
            // Create cards up to available images
            const availableImages = Math.min(cardCount, astronautImages.length);
            
            for (let i = 0; i < availableImages; i++) {
                const card = document.createElement('div');
                
                card.className = `character-image character-${i + 1}`;
                card.style.backgroundImage = `url(${astronautImages[i]})`;
                
                // Set dynamic card size based on screen
                card.style.width = screenInfo.cardSize + 'px';
                card.style.height = screenInfo.cardSize + 'px';
                
                // Set positions for all phases
                if (initialPositions[i]) {
                    card.dataset.targetX = initialPositions[i].x;
                    card.dataset.targetY = initialPositions[i].y;
                }
                if (ripplePositions[i]) {
                    card.dataset.rippleX = ripplePositions[i].x;
                    card.dataset.rippleY = ripplePositions[i].y;
                }
                
                stage.appendChild(card);
            }
            
            // If we need more cards than available images, duplicate some
            if (cardCount > astronautImages.length) {
                for (let i = astronautImages.length; i < cardCount; i++) {
                    const sourceIndex = i % astronautImages.length;
                    const card = document.createElement('div');
                    
                    card.className = `character-image character-${i + 1}`;
                    card.style.backgroundImage = `url(${astronautImages[sourceIndex]})`;
                    
                    // Set dynamic card size
                    card.style.width = screenInfo.cardSize + 'px';
                    card.style.height = screenInfo.cardSize + 'px';
                    
                    // Set positions for all phases
                    if (initialPositions[i]) {
                        card.dataset.targetX = initialPositions[i].x;
                        card.dataset.targetY = initialPositions[i].y;
                    }
                    if (ripplePositions[i]) {
                        card.dataset.rippleX = ripplePositions[i].x;
                        card.dataset.rippleY = ripplePositions[i].y;
                    }
                    
                    stage.appendChild(card);
                }
            }
        }

        function applyGridPositions() {
            const cards = document.querySelectorAll('.character-image');
            cards.forEach(card => {
                const targetX = card.dataset.targetX;
                const targetY = card.dataset.targetY;
                if (targetX && targetY) {
                    card.style.left = targetX + '%';
                    card.style.top = targetY + '%';
                }
            });
        }

        function applyRipplePositions() {
            const cards = document.querySelectorAll('.character-image');
            cards.forEach(card => {
                const rippleX = card.dataset.rippleX;
                const rippleY = card.dataset.rippleY;
                if (rippleX && rippleY) {
                    card.style.left = rippleX + '%';
                    card.style.top = rippleY + '%';
                }
            });
        }
        
        function startAnimation() {
            const stage = document.getElementById('stage');
            const energyWave = document.getElementById('energyWave');
            const rippleWave = document.getElementById('rippleWave');
            
            // Clear any existing timeouts
            if (animationTimeout) clearTimeout(animationTimeout);
            
            // Reset to phase 1 - all images at center, invisible
            stage.className = 'stage phase-1';
            rippleWave.classList.remove('active');
            
            // Phase 2: Images expand to initial grid positions (3 seconds)
            setTimeout(() => {
                stage.className = 'stage phase-2';
                applyGridPositions();
                createOutwardParticlesFromCenter();
                // Expansion effect removed
            }, 3000);

            // Phase 3: Ripple effect pushes images away from center (final phase - 2 seconds after phase 2)
            setTimeout(() => {
                stage.className = 'stage phase-3';
                rippleWave.classList.add('active');
                applyStaggeredRipple(); // Use staggered ripple
                createRippleParticles();
            }, 5000);
        }
        
        function createOutwardParticlesFromCenter() {
            // Particle animation removed
        }

        function applyStaggeredRipple() {
            const cards = document.querySelectorAll('.character-image');
            const centerX = 50;
            const centerY = 50;

            cards.forEach(card => {
                const rippleX = parseFloat(card.dataset.rippleX);
                const rippleY = parseFloat(card.dataset.rippleY);

                if (!isNaN(rippleX) && !isNaN(rippleY)) {
                    const dx = rippleX - centerX;
                    const dy = rippleY - centerY;
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    // Delay based on distance from the center. Max delay of ~500ms for farthest cards.
                    const delay = distance * 10;

                    setTimeout(() => {
                        card.style.left = rippleX + '%';
                        card.style.top = rippleY + '%';
                    }, delay);
                }
            });
        }

        function createRippleParticles() {
            // Ripple particle animation removed
        }
        
        // Initialize everything when page loads
        window.addEventListener('load', () => {
            createCharacterCards();
            setTimeout(startAnimation, 500);
        });
        
        // Handle window resize
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                createCharacterCards();
                
                const stage = document.getElementById('stage');
                if (stage.classList.contains('phase-3')) {
                    setTimeout(startAnimation, 100);
                }
            }, 250);
        });
    </script>
</body>
</html>